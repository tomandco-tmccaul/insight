# Firebase App Hosting configuration
# Documentation: https://firebase.google.com/docs/app-hosting

runConfig:
  # Runtime configuration for Node.js
  runtime: nodejs22
  
  # CPU and memory allocation
  cpu: 1
  memory: 1Gi
  concurrency: 100
  maxInstances: 10
  minInstances: 0
  
  # Environment variables (non-sensitive, runtime only)
  environmentVariables:
    # BigQuery Configuration
    BIGQUERY_DATASET_ID: 'insight_analytics'
    BIGQUERY_LOCATION: 'europe-west2'
  
  # Secrets (sensitive data stored in Google Secret Manager)
  # Note: NEXT_PUBLIC_* variables are NOT here because they must be available at BUILD TIME
  # They are configured in build.environmentVariables instead
  secrets:
    # Google AI/Gemini API Key for AI features
    - secretId: GOOGLE_GENAI_API_KEY
      key: GOOGLE_GENAI_API_KEY
    
    # Firebase Admin SDK Configuration (server-side only)
    - secretId: FIREBASE_PROJECT_ID
      key: FIREBASE_PROJECT_ID
    
    - secretId: FIREBASE_CLIENT_EMAIL
      key: FIREBASE_CLIENT_EMAIL
    
    - secretId: FIREBASE_PRIVATE_KEY
      key: FIREBASE_PRIVATE_KEY
    
    # Google Cloud Project
    - secretId: GOOGLE_CLOUD_PROJECT
      key: GOOGLE_CLOUD_PROJECT

# Build configuration
build:
  # Build command (Next.js build)
  buildCommand: npm run build
  
  # Environment variables available during build
  # IMPORTANT: NEXT_PUBLIC_* variables MUST be here because they're embedded in the client bundle at build time
  environmentVariables:
    NODE_ENV: 'production'
    
    # Firebase Client Configuration (public, embedded in client bundle)
    NEXT_PUBLIC_FIREBASE_API_KEY: 'AIzaSyCkkB5Fcq51g1lmvoP0vgJLvVFJBEsS4A0'
    NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN: 'insight-dashboard-1761555293.firebaseapp.com'
    NEXT_PUBLIC_FIREBASE_PROJECT_ID: 'insight-dashboard-1761555293'
    NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET: 'insight-dashboard-1761555293.appspot.com'
    NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID: '292720819141'
    NEXT_PUBLIC_FIREBASE_APP_ID: '1:292720819141:web:13a548b1595558cffa29ac'
    NEXT_PUBLIC_USE_FIREBASE_EMULATOR: 'false'

