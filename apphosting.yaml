# Firebase App Hosting configuration
# Documentation: https://firebase.google.com/docs/app-hosting

runConfig:
  # Runtime configuration for Node.js
  runtime: nodejs22
  
  # CPU and memory allocation
  cpu: 1
  memory: 1Gi
  concurrency: 100
  maxInstances: 10
  minInstances: 0
  
  # Secrets (sensitive data stored in Google Secret Manager)
  # Note: NEXT_PUBLIC_* variables are NOT here - they are configured in the env section with BUILD availability
  secrets:
    # Google AI/Gemini API Key for AI features
    - secretId: GOOGLE_GENAI_API_KEY
      key: GOOGLE_GENAI_API_KEY
    
    # Firebase Admin SDK Configuration (server-side only)
    - secretId: FIREBASE_PROJECT_ID
      key: FIREBASE_PROJECT_ID
    
    - secretId: FIREBASE_CLIENT_EMAIL
      key: FIREBASE_CLIENT_EMAIL
    
    - secretId: FIREBASE_PRIVATE_KEY
      key: FIREBASE_PRIVATE_KEY
    
    # Google Cloud Project
    - secretId: GOOGLE_CLOUD_PROJECT
      key: GOOGLE_CLOUD_PROJECT

# Environment variables configuration
# Variables with BUILD availability are accessible during the build process
# Variables with RUNTIME availability are accessible at runtime
env:
  - variable: NODE_ENV
    value: production
    availability:
      - BUILD
      - RUNTIME
  
  # Firebase Client Configuration (public, embedded in client bundle at BUILD time)
  - variable: NEXT_PUBLIC_FIREBASE_API_KEY
    value: AIzaSyCkkB5Fcq51g1lmvoP0vgJLvVFJBEsS4A0
    availability:
      - BUILD
      - RUNTIME
  
  - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
    value: insight-dashboard-1761555293.firebaseapp.com
    availability:
      - BUILD
      - RUNTIME
  
  - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
    value: insight-dashboard-1761555293
    availability:
      - BUILD
      - RUNTIME
  
  - variable: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
    value: insight-dashboard-1761555293.appspot.com
    availability:
      - BUILD
      - RUNTIME
  
  - variable: NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID
    value: '292720819141'
    availability:
      - BUILD
      - RUNTIME
  
  - variable: NEXT_PUBLIC_FIREBASE_APP_ID
    value: 1:292720819141:web:13a548b1595558cffa29ac
    availability:
      - BUILD
      - RUNTIME
  
  - variable: NEXT_PUBLIC_USE_FIREBASE_EMULATOR
    value: 'false'
    availability:
      - BUILD
      - RUNTIME
  
  # BigQuery Configuration (runtime only)
  - variable: BIGQUERY_DATASET_ID
    value: insight_analytics
    availability:
      - RUNTIME
  
  - variable: BIGQUERY_LOCATION
    value: europe-west2
    availability:
      - RUNTIME

# Build configuration
build:
  # Build command (Next.js build)
  buildCommand: npm run build

